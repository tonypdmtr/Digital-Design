;*******************************************************************************
; Hex to decimal converter
;*******************************************************************************

STACKTOP            equ       $01FF
ROM                 equ       $D000

;*******************************************************************************
                    #RAM
;*******************************************************************************

decimal             rmb       1
hex                 rmb       1

;*******************************************************************************
                    #ROM
;*******************************************************************************
                    org       ROM

Start               proc
                    clr       decimal
                    clr       hex
                    lds       #STACKTOP
Loop@@              bsr       Hex2Dec
                    bra       Loop@@

;*******************************************************************************

Hex2Dec             proc
                    ldx       #10
                    clra
                    ldb       hex
                    idiv                          ; divide hex by 10 (0A)
                    stb       decimal
                    xgdx                          ; swap x and d because we can't move x directly to decimal
                    lslb:4                        ; move most significant byte over
                    addb      decimal             ; combine the bytes
                    stb       decimal
                    rts

;*******************************************************************************
                    #VECTORS
;*******************************************************************************

                    org       $FFFE
                    dw        Start
